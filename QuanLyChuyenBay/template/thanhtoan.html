{% extends 'layout/base.html' %}

{% block content %}
<h1>Đặt vé cho chuyến bay: {{ chuyen_bay.ten_chuyen_bay }}</h1>
<form method="POST" action="{{ url_for('thanhtoan', chuyen_bay_id=chuyen_bay.id) }}">
    <p>Hành khách: <input type="text" name="ten_hanh_khach" required></p>
    <p>CMND/CCCD: <input type="text" name="cccd" required></p>
    <p>Điện thoại: <input type="text" name="sdt" required></p>
    <p>Hạng ghế:</p>
    <select name="hang_ve" id="hang_ve" required>
        {% for hg in hang_ghe_chuyen_bay %}
        <option value="{{ hg.id }}" data-gia="{{ hg.gia }}">
            {{ hg.hang_ghe.ten_hang_ghe }} - Giá: {{ hg.gia }} - Còn: {{ hg.so_luong_ghe }}
        </option>
        {% endfor %}
    </select>
    <p>Giá tiền: <span id="gia_tien">{{ hang_ghe_chuyen_bay[0].gia }}</span> VNĐ</p>  <!-- Hiển thị giá khởi đầu -->
    <button type="submit">Đặt vé</button>
</form>
<a href="{{ url_for('chuyenbaylistactive') }}">Quay lại danh sách</a>

<!-- JavaScript để cập nhật giá tiền khi thay đổi hạng ghế -->
<script>
    document.addEventListener("DOMContentLoaded", function() {
        var hangVeSelect = document.getElementById("hang_ve");
        var giaTienSpan = document.getElementById("gia_tien");

        hangVeSelect.addEventListener("change", function() {
            var selectedOption = hangVeSelect.options[hangVeSelect.selectedIndex];
            var giaTien = selectedOption.getAttribute("data-gia");
            giaTienSpan.textContent = giaTien;
        });

        // Gọi sự kiện để cập nhật ngay khi trang tải
        hangVeSelect.dispatchEvent(new Event('change'));
    });
</script>
{% endblock %}
